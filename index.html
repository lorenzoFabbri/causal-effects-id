<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Identification and Estimation of Causal Effects</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='main.css' rel='stylesheet' type='text/css' /> 
<meta content='main.tex' name='src' /> 
</head><body>
   <div class='maketitle'>
                                                                                                  
                                                                                                  
                                                                                                  
                                                                                                  

<h2 class='titleHead'>Identification and Estimation of Causal Effects</h2>
<div class='author'> <span class='cmr-12x-x-120'>Lorenzo Fabbri </span></div><br />
<div class='date'><span class='cmr-12x-x-120'>July 5, 2024</span></div>
   </div>
   <h3 class='likesectionHead' id='contents'><a id='x1-1000'></a>Contents</h3>
   <div class='tableofcontents'>
   <span class='sectionToc'>1 <a href='#resources' id='QQ2-1-2'>Resources</a></span>
<br />   <span class='sectionToc'>2 <a href='#timeinvariant-exposures' id='QQ2-1-3'>Time-invariant Exposures</a></span>
<br />    <span class='subsectionToc'>2.1 <a href='#deterministic-treatment-regimes' id='QQ2-1-4'>Deterministic Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>2.1.1 <a href='#deterministic-static-treatment-regimes' id='QQ2-1-5'>Deterministic Static Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>2.1.2 <a href='#deterministic-dynamic-treatment-regimes' id='QQ2-1-8'>Deterministic Dynamic Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>2.1.3 <a href='#deterministic-natural-treatment-regimes' id='QQ2-1-10'>Deterministic Natural Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>2.1.4 <a href='#modified-treatment-policies' id='QQ2-1-13'>Modified Treatment Policies</a></span>
<br />    <span class='subsectionToc'>2.2 <a href='#random-treatment-regimes' id='QQ2-1-14'>Random Treatment Regimes</a></span>
<br />   <span class='sectionToc'>3 <a href='#timevarying-exposures' id='QQ2-1-15'>Time-varying Exposures</a></span>
<br />    <span class='subsectionToc'>3.1 <a href='#deterministic-treatment-regimes1' id='QQ2-1-16'>Deterministic Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.1.1 <a href='#deterministic-static-treatment-regimes1' id='QQ2-1-17'>Deterministic Static Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.1.2 <a href='#deterministic-dynamic-treatment-regimes1' id='QQ2-1-20'>Deterministic Dynamic Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.1.3 <a href='#deterministic-natural-treatment-regimes1' id='QQ2-1-21'>Deterministic Natural Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.1.4 <a href='#modified-treatment-policies1' id='QQ2-1-23'>Modified Treatment Policies</a></span>
<br />    <span class='subsectionToc'>3.2 <a href='#random-treatment-regimes1' id='QQ2-1-24'>Random Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.2.1 <a href='#random-static-treatment-regimes' id='QQ2-1-25'>Random Static Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.2.2 <a href='#random-dynamic-treatment-regimes' id='QQ2-1-26'>Random Dynamic Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.2.3 <a href='#random-natural-treatment-regimes' id='QQ2-1-27'>Random Natural Treatment Regimes</a></span>
<br />     <span class='subsubsectionToc'>3.2.4 <a href='#modified-treatment-policies2' id='QQ2-1-28'>Modified Treatment Policies</a></span>
   </div>
                                                                                                  
                                                                                                  
                                                                                                  
                                                                                                  
   <h3 class='sectionHead' id='resources'><span class='titlemark'>1   </span> <a id='x1-20001'></a>Resources</h3>
      <ul class='itemize1'>
      <li class='itemize'>
      <!-- l. 58 --><p class='noindent'>G-computation, IPTW, and EIF-based estimators for when: </p>
           <ul class='itemize2'>
           <li class='itemize'>There are more than two time points.
           </li>
           <li class='itemize'>There is more than one exposure.
           </li>
           <li class='itemize'>The exposures are continuous (IPTW).</li></ul>
      </li>
      <li class='itemize'>Do the terms <span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span>) go away because we are setting the exposure <span class='cmmi-12'>A </span>to <span class='cmmi-12'>a</span>, or are they incorporated with
      <span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>) into <span class='cmmi-12'>f</span>(<span class='cmmi-12'>a,l</span>)? If they are removed, where does the summation over <span class='cmmi-12'>a </span>come from for natural-value
      based interventions?
      </li>
      <li class='itemize'>What is the difference between <span class='cmmi-12'>a</span><sup><span class='cmsy-8'>∗</span></sup>, <span class='cmmi-12'>a</span>, and <span class='cmmi-12'>a</span><sup><span class='cmr-8'>+</span><span class='cmmi-8'>g</span></sup>?
      </li>
      <li class='itemize'><span class='cmmi-12'>E</span>[<span class='cmmi-12'>Y</span> <sup><span class='cmmi-8'>g</span></sup><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,a</span><sup><span class='cmr-8'>+</span><span class='cmmi-8'>g</span></sup>]<span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sup><span class='cmr-8'>+</span><span class='cmmi-8'>g</span></sup><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>a</span>): what if <span class='cmmi-12'>A </span>is continuous? Just multiply?
      </li>
      <li class='itemize'>Document FF; GitHub discussion; Stack-Exchange posts.</li></ul>
<!-- l. 71 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='timeinvariant-exposures'><span class='titlemark'>2   </span> <a id='x1-30002'></a>Time-invariant Exposures</h3>
<!-- l. 74 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='deterministic-treatment-regimes'><span class='titlemark'>2.1   </span> <a id='x1-40002.1'></a>Deterministic Treatment Regimes</h4>
<!-- l. 75 --><p class='noindent'>The rule for assigning treatment does so with probability 1.
                                                                                                  
                                                                                                  
</p><!-- l. 77 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='deterministic-static-treatment-regimes'><span class='titlemark'>2.1.1   </span> <a id='x1-50002.1.1'></a>Deterministic Static Treatment Regimes</h5>
<!-- l. 78 --><p class='noindent'>The rule for assigning treatment does not depend on past treatment or covariates.
</p>
   <figure class='figure' id='-a-swig-representing-a-static-treatment-regime'> 

                                                                                                  
                                                                                                  
<a id='x1-50011'></a>
                                                                                                  
                                                                                                  
<!-- l. 104 --><p class='noindent'> LA<span class='cmsy-10x-x-120'>|</span>aY<sup><span class='cmmi-8'>a</span></sup>
</p>
<figcaption class='caption'><span class='id'>Figure 1: </span><span class='content'>A SWIG representing a static treatment regime.</span></figcaption><!-- tex4ht:label?: x1-50011  -->
                                                                                                  
                                                                                                  
   </figure>
<!-- l. 109 --><p class='indent'>   The joint density is:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='f (y, l,a ) = f (y|l,a)f (a |l)f(l).
' class='math-display' src='main0x.svg' /><a id='x1-5002r1'></a></div>
   </td><td class='equation-label'>(1)</td></tr></table>
<!-- l. 113 --><p class='nopar'>
</p><!-- l. 115 --><p class='indent'>   After intervening on the exposure <span class='cmmi-12'>A</span>, we have:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='  G
f  (y,l) = f(y|l,a)f(l).
' class='math-display' src='main1x.svg' /><a id='x1-5003r2'></a></div>
   </td><td class='equation-label'>(2)</td></tr></table>
<!-- l. 119 --><p class='nopar'>
</p><!-- l. 121 --><p class='indent'>   Thus, the expected value of the outcome <span class='cmmi-12'>Y </span>is:
</p><!-- l. 123 --><p class='indent'>
                                                                                                  
                                                                                                  
</p><table class='align'>
                             <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main2x.svg' /></td>                             <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>yf</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y</span>)</td>                                                                              <td class='align-label'><a id='x1-5004r3'></a>(3)
                             </td></tr><tr><td class='align-odd'></td>                                   <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>y </span><span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l</span>)</td>                                                                       <td class='align-label'><a id='x1-5005r4'></a>(4)
                             </td></tr><tr><td class='align-odd'></td>                                   <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span></sub><span class='cmmi-12'>yf</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,</span><span id='textcolor1'><span class='cmmi-12'>a</span></span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>)</td>                                                                   <td class='align-label'><a id='x1-5006r5'></a>(5)
                             </td></tr><tr><td class='align-odd'></td>                                   <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub><span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[Y |A = a,L  = l]' class='left' src='main3x.svg' /> <span class='cmmi-12'>f</span>(<span class='cmmi-12'>L </span>= <span class='cmmi-12'>l</span>)<span class='cmmi-12'>.</span></td>                                                          <td class='align-label'><a id='x1-5007r6'></a>(6)                             </td></tr></table>
<!-- l. 130 --><p class='noindent'><span class='likeparagraphHead' id='algorithms'><a id='x1-6000'></a>Algorithms</span>
   One estimator of <span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup>[<span class='cmmi-12'>Y </span>] is called <span class='cmbx-12'>parametric g-computation formula</span>, and is based on an outcome
model alone. For the simple case of a deterministic static intervention with one exposure and a single time
point, the pseudo-algorithm reads as follows:
</p><!-- l. 133 --><p class='indent'>
      </p><ol class='enumerate1'>
<li class='enumerate' id='x1-6002x1'>Fit a regression model with dependent variable <span class='cmmi-12'>Y </span>and independent variables <span class='cmmi-12'>A </span>and <span class='cmmi-12'>L</span>.
      </li>
<li class='enumerate' id='x1-6004x2'>Estimate the outcome <span class='cmmi-12'>Y</span> <sup><span class='cmmi-8'>a</span></sup> using the model fit in the previous point but changing the exposure
      according to the intervention rule <span class='cmmi-12'>G</span>.
      </li>
<li class='enumerate' id='x1-6006x3'>Take the average of <span class='cmmi-12'>Ŷ</span><sup><span class='cmmi-8'>a</span></sup> over the confounders <span class='cmmi-12'>L</span>.</li></ol>
<!-- l. 139 --><p class='indent'>   In the case of multiple exposures (e.g., if <span class='cmmi-12'>A </span>is actually a vector of variables), the g-formula would remain the
same <span class='footnote-mark'><a href='main2.html#fn1x0'><sup class='textsuperscript'>1</sup></a></span><a id='x1-6007f1'></a> ,
but the pseudo-algorithm should be modified to take into account that the intervention rule now applies to
all exposures <span class='cmmi-12'>a </span><span class='cmsy-10x-x-120'>∈ </span><span class='cmbx-12'>A</span>.
</p><!-- l. 141 --><p class='indent'>   A second estimator of <span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup>[<span class='cmmi-12'>Y </span>] is based on modeling the exposure mechanism, rather than the outcome,
and it is referred to as <span class='cmbx-12'>inverse probability of treatment weighting </span>(IPTW) estimator. This can be
derived nothing that the g-formula for <span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup>[<span class='cmmi-12'>Y </span>] can be rewritten as follows:
</p><!-- l. 143 --><p class='indent'>
                                                                                                  
                                                                                                  
</p><table class='align'>
                                 <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main4x.svg' /></td>                                 <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span></sub><span class='cmmi-12'>yf</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,</span><span id='textcolor2'><span class='cmmi-12'>a</span></span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>)</td>                                                                    <td class='align-label'><a id='x1-6009r7'></a>(7)
                                 </td></tr><tr><td class='align-odd'></td>                                       <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span></sub><span class='cmmi-12'>yf</span>(<span class='cmmi-12'>y,</span><span id='textcolor3'><span class='cmmi-12'>a</span></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span>)<img align='middle' alt='-f(l)-
f(a|l)' class='frac' src='main5x.svg' /></td>                                                                  <td class='align-label'><a id='x1-6010r8'></a>(8)
                                 </td></tr><tr><td class='align-odd'></td>                                       <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub><span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[          ]
 --Y-A--|L
 f (A |L)' class='left' src='main6x.svg' /><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>)</td>                                                                    <td class='align-label'><a id='x1-6011r9'></a>(9)
                                 </td></tr><tr><td class='align-odd'></td>                                       <td class='align-even'> = <span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[   YA   ]
  -------
  f(A |L )' class='left' src='main7x.svg' /><span class='cmmi-12'>.</span></td>                                                                              <td class='align-label'><a id='x1-6012r10'></a>(10)                                 </td></tr></table>
<!-- l. 150 --><p class='indent'>   The pseudo-algorithm for a binary exposure <span class='cmmi-12'>A </span>reads as follows (for simplicity, we do not consider the
censoring mechanism <span class='cmmi-12'>C </span>here):
      </p><ol class='enumerate1'>
<li class='enumerate' id='x1-6014x1'>Fit a model with dependent variable <span class='cmmi-12'>A </span>and independent variables <span class='cmmi-12'>L</span>.
      </li>
<li class='enumerate' id='x1-6016x2'>Denoting the predictions from this model as <span class='cmmi-12'>p</span><sub><span class='cmmi-8'>a</span></sub>, estimate the weights <span class='cmmi-12'>w</span><sub><span class='cmmi-8'>a</span></sub> = <img align='middle' alt='--------1--------
A×pa+(1−A)×(1−pa)' class='frac' src='main8x.svg' />.
      </li>
<li class='enumerate' id='x1-6018x3'>Take the average of <span class='cmmi-12'>w</span><sub><span class='cmmi-8'>a</span></sub> <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>Y </span>over the confounders L.</li></ol>
   <h5 class='subsubsectionHead' id='deterministic-dynamic-treatment-regimes'><span class='titlemark'>2.1.2   </span> <a id='x1-70002.1.2'></a>Deterministic Dynamic Treatment Regimes</h5>
<!-- l. 159 --><p class='noindent'>The rule for assigning treatment depends on past treatment or covariates.
</p>
   <figure class='figure' id='-a-swig-representing-a-dynamic-treatment-regime'> 

                                                                                                  
                                                                                                  
<a id='x1-70012'></a>
                                                                                                  
                                                                                                  
<!-- l. 186 --><p class='noindent'> LA<span class='cmsy-10x-x-120'>|</span>a<sup><span class='cmmi-8'>g</span></sup>Y<sup><span class='cmmi-8'>g</span></sup>
</p>
<figcaption class='caption'><span class='id'>Figure 2: </span><span class='content'>A SWIG representing a dynamic treatment regime.</span></figcaption><!-- tex4ht:label?: x1-70012  -->
                                                                                                  
                                                                                                  
   </figure>
<!-- l. 191 --><p class='indent'>   The joint density is:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='         g           g    g
f(y,l,a,a ) = f (y |l,a )f(a |l)f (a|l)f(l).
' class='math-display' src='main9x.svg' /><a id='x1-7002r11'></a></div>
   </td><td class='equation-label'>(11)</td></tr></table>
<!-- l. 195 --><p class='nopar'>
</p><!-- l. 197 --><p class='indent'>   After intervening on the exposure <span class='cmmi-12'>A</span>, we have:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='  G      g           g    g
f  (y,l,a ) = f(y|l,a )f (a |l)f(l).
' class='math-display' src='main10x.svg' /><a id='x1-7003r12'></a></div>
   </td><td class='equation-label'>(12)</td></tr></table>
<!-- l. 201 --><p class='nopar'>
</p><!-- l. 203 --><p class='indent'>   Thus, the expected value of the outcome <span class='cmmi-12'>Y </span>is:
</p><!-- l. 205 --><p class='indent'>
                                                                                                  
                                                                                                  
</p><table class='align'>
                     <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main11x.svg' /></td>                     <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>yf</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y</span>)</td>                                                                                <td class='align-label'><a id='x1-7004r13'></a>(13)
                     </td></tr><tr><td class='align-odd'></td>                           <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>y </span><span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l,</span><span id='textcolor4'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span>)</td>                                                                <td class='align-label'><a id='x1-7005r14'></a>(14)
                     </td></tr><tr><td class='align-odd'></td>                           <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='cmmi-12'>yf</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,</span><span id='textcolor5'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmmi-12'>f</span>(<span id='textcolor6'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>)</td>                                                        <td class='align-label'><a id='x1-7006r15'></a>(15)
                     </td></tr><tr><td class='align-odd'></td>                           <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='         g
[Y |A = a ,L  = l]' class='left' src='main12x.svg' /> <span class='cmmi-12'>f</span>(<span id='textcolor7'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>L </span>= <span class='cmmi-12'>l</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>L </span>= <span class='cmmi-12'>l</span>)<span class='cmmi-12'>.</span></td>                                          <td class='align-label'><a id='x1-7007r16'></a>(16)                     </td></tr></table>
   <h5 class='subsubsectionHead' id='deterministic-natural-treatment-regimes'><span class='titlemark'>2.1.3   </span> <a id='x1-80002.1.3'></a>Deterministic Natural Treatment Regimes</h5>
<!-- l. 213 --><p class='noindent'>The rule for assigning treatment depends on its natural value.
</p>
   <figure class='figure' id='-a-swig-representing-a-natural-treatment-regime'> 

                                                                                                  
                                                                                                  
<a id='x1-80013'></a>
                                                                                                  
                                                                                                  
<!-- l. 240 --><p class='noindent'> LA<span class='msam-10x-x-120'>−−→</span>a<sup><span class='cmmi-8'>g</span> </sup>Y<sup><span class='cmmi-8'>g</span> </sup>
</p>
<figcaption class='caption'><span class='id'>Figure 3: </span><span class='content'>A SWIG representing a natural treatment regime.</span></figcaption><!-- tex4ht:label?: x1-80013  -->
                                                                                                  
                                                                                                  
   </figure>
<!-- l. 245 --><p class='indent'>   The joint density is:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='         g           g    g
f(y,l,a,a ) = f(y |l,a )f(a |l,a)f(a|l)f (l).
' class='math-display' src='main13x.svg' /><a id='x1-8002r17'></a></div>
   </td><td class='equation-label'>(17)</td></tr></table>
<!-- l. 249 --><p class='nopar'>
</p><!-- l. 251 --><p class='indent'>   After intervening on the exposure <span class='cmmi-12'>A</span>, we have:
</p>
   <table class='equation'><tr><td>
   <div class='math-display'>
<img alt='  G        g           g    g
f  (y,l,a,a ) = f(y|l,a )f(a |l,a)f (a |l)f(l).
' class='math-display' src='main14x.svg' /><a id='x1-8003r18'></a></div>
   </td><td class='equation-label'>(18)</td></tr></table>
<!-- l. 255 --><p class='nopar'>
</p><!-- l. 257 --><p class='indent'>   Thus, the expected value of the outcome <span class='cmmi-12'>Y </span>is:
</p><!-- l. 259 --><p class='indent'>
                                                                                                  
                                                                                                  
</p><table class='align'>
               <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main15x.svg' /></td>               <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>yf</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y</span>)</td>                                                                                 <td class='align-label'><a id='x1-8004r19'></a>(19)
               </td></tr><tr><td class='align-odd'></td>                      <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>y </span><span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>a</span></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l,a,</span><span id='textcolor8'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span>)</td>                                                          <td class='align-label'><a id='x1-8005r20'></a>(20)
               </td></tr><tr><td class='align-odd'></td>                      <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span></sub> <span class='cmex-10x-x-120'>∑</span>
            <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='cmmi-12'>yf</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,</span><span id='textcolor9'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmmi-12'>f</span>(<span id='textcolor10'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l,a</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span>)</td>                                            <td class='align-label'><a id='x1-8006r21'></a>(21)
               </td></tr><tr><td class='align-odd'></td>                      <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>a</span></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='         g
[Y |A  = a ,L =  l]' class='left' src='main16x.svg' /> <span class='cmmi-12'>f</span>(<span id='textcolor11'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>a,L </span>= <span class='cmmi-12'>l</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>L </span>= <span class='cmmi-12'>l</span>)<span class='cmmi-12'>.</span></td>                              <td class='align-label'><a id='x1-8007r22'></a>(22)               </td></tr></table>
<!-- l. 266 --><p class='noindent'><span class='likeparagraphHead' id='algorithms1'><a id='x1-9000'></a>Algorithms</span>
   One estimator of <span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup>[<span class='cmmi-12'>Y </span>] is the <span class='cmbx-12'>parametric g-computation formula</span>. For the simple case of a
deterministic intervention that depends on the natural value of a single exposure and a single time point, it
suffices to notice that Equation <a href='#x1-8007r22'>22<!-- tex4ht:ref: eq:gcomp_nat  --></a> is equivalent to:
</p><!-- l. 269 --><p class='indent'>
</p><table class='align'>
                        <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main17x.svg' /></td>                        <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>a</span></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sup><span class='cmmi-6'>g</span></sup></sub><span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='         g
[Y |A  = a ,L =  l]' class='left' src='main18x.svg' /> <span class='cmmi-12'>f</span>(<span id='textcolor12'><span class='cmmi-12'>a</span><sup><span class='cmmi-8'>g</span></sup></span><span class='cmmi-12'>,a,l</span>)<span class='cmmi-12'>.</span></td>                                                <td class='align-label'><a id='x1-9001r23'></a>(23)                        </td></tr></table>
<!-- l. 273 --><p class='indent'>   The pseudo-algorithm then reads as follows:
</p><!-- l. 275 --><p class='indent'>
      </p><ol class='enumerate1'>
<li class='enumerate' id='x1-9003x1'>Fit a regression model with dependent variable <span class='cmmi-12'>Y </span>and independent variables <span class='cmmi-12'>A </span>and <span class='cmmi-12'>L</span>.
      </li>
<li class='enumerate' id='x1-9005x2'>Estimate the outcome <span class='cmmi-12'>Y</span> <sup><span class='cmmi-8'>a</span></sup> using the model fit in the previous point but changing the exposure
      according to the intervention rule <span class='cmmi-12'>G</span>.
                                                                                                  
                                                                                                  
      </li>
<li class='enumerate' id='x1-9007x3'>Take the average of <span class='cmmi-12'>Ŷ</span><sup><span class='cmmi-8'>a</span></sup> over the confounders <span class='cmmi-12'>L</span>.</li></ol>
<!-- l. 281 --><p class='indent'>   In the case of multiple exposures (e.g., if <span class='cmmi-12'>A </span>is actually a vector of variables), the g-formula would remain the
same <span class='footnote-mark'><a href='main3.html#fn2x0'><sup class='textsuperscript'>2</sup></a></span><a id='x1-9008f2'></a> ,
but the pseudo-algorithm should be modified to take into account that the intervention rule now applies to
all exposures <span class='cmmi-12'>a </span><span class='cmsy-10x-x-120'>∈ </span><span class='cmbx-12'>A</span>.
</p>
   <h5 class='subsubsectionHead' id='modified-treatment-policies'><span class='titlemark'>2.1.4   </span> <a id='x1-100002.1.4'></a>Modified Treatment Policies</h5>
<!-- l. 285 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='random-treatment-regimes'><span class='titlemark'>2.2   </span> <a id='x1-110002.2'></a>Random Treatment Regimes</h4>
<!-- l. 286 --><p class='noindent'>The rule for assigning treatment does so with probability between 0 and 1.
</p><!-- l. 289 --><p class='noindent'>
</p>
   <h3 class='sectionHead' id='timevarying-exposures'><span class='titlemark'>3   </span> <a id='x1-120003'></a>Time-varying Exposures</h3>
<!-- l. 292 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='deterministic-treatment-regimes1'><span class='titlemark'>3.1   </span> <a id='x1-130003.1'></a>Deterministic Treatment Regimes</h4>
<!-- l. 293 --><p class='noindent'>The rule for assigning treatment does so with probability 1.
</p><!-- l. 295 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='deterministic-static-treatment-regimes1'><span class='titlemark'>3.1.1   </span> <a id='x1-140003.1.1'></a>Deterministic Static Treatment Regimes</h5>
<!-- l. 296 --><p class='noindent'>The rule for assigning treatment does not depend on past treatment or covariates.
</p><!-- l. 298 --><p class='indent'>   If <span class='cmmi-12'>f</span><sup>int</sup>(<span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>ā</span><sub><span class='cmmi-8'>k</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span class='bar-css'><span class='cmmi-12'>D</span></span><sub><span class='cmmi-8'>k</span></sub> = 0) is either 0 or 1 for each <span class='cmmi-12'>ā</span><sub><span class='cmmi-8'>k</span></sub> and for <span class='cmmi-12'>k </span>= 0<span class='cmmi-12'>,…,K</span>. In particular, given the regime
<span class='cmmi-12'>g </span>= (<span class='cmmi-12'>g</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,…,g</span><sub><span class='cmmi-8'>K</span></sub>), <span class='cmmi-12'>f</span><sup>int</sup>(<span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>ā</span><sub><span class='cmmi-8'>k</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,</span><span class='bar-css'><span class='cmmi-12'>D</span></span><sub>
<span class='cmmi-8'>k</span></sub> = 0) = 1 if <span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub> = <span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><sup><span class='cmmi-8'>g</span></sup>, and 0 otherwise, with <span class='cmmi-12'>a</span><sub>
<span class='cmmi-8'>s</span></sub><sup><span class='cmmi-8'>g</span></sup> = <span class='cmmi-12'>g</span><sub>
<span class='cmmi-8'>s</span></sub>(<span class='cmmi-12'>ā</span><sub><span class='cmmi-8'>s</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>).
</p>
   <figure class='figure' id='-a-swig-representing-a-static-treatment-regime1'> 

                                                                                                  
                                                                                                  
<a id='x1-140014'></a>
                                                                                                  
                                                                                                  
<!-- l. 339 --><p class='noindent'>  L<sub><span class='cmr-8'>0</span></sub>A<sub><span class='cmr-8'>0</span></sub><span class='cmsy-10x-x-120'>|</span>a<sub><span class='cmr-8'>0</span> </sub>L<sub><span class='cmr-8'>1</span> </sub><sup><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sup>A<sub>
<span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sup><span class='cmsy-10x-x-120'>|</span>a<sub>
<span class='cmr-8'>1</span></sub>Y<sup><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub><span class='cmmi-8'>,a</span><sub><span class='cmr-6'>1</span></sub></sup>
</p>
<figcaption class='caption'><span class='id'>Figure 4: </span><span class='content'>A SWIG representing a static treatment regime.</span></figcaption><!-- tex4ht:label?: x1-140014  -->
                                                                                                  
                                                                                                  
   </figure>
<!-- l. 344 --><p class='indent'>   The joint density is:
</p><!-- l. 346 --><p class='indent'>
</p><table class='align'>
                          <tr><td class='align-odd'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y,l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>1</span></sub>) =</td>                          <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>1</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                               <td class='align-label'><a id='x1-14002r24'></a>(24)
                          </td></tr><tr><td class='align-odd'></td>                                            <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                    <td class='align-label'><a id='x1-14003r25'></a>(25)
                          </td></tr><tr><td class='align-odd'></td>                                            <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span></td>                                                                <td class='align-label'><a id='x1-14004r26'></a>(26)                          </td></tr></table>
<!-- l. 352 --><p class='indent'>   After intervening on the exposure <span class='cmmi-12'>A </span>at both time points, we have:
</p><!-- l. 354 --><p class='indent'>
</p><table class='align'>
                         <tr><td class='align-odd'><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>1</span></sub>) =</td>                         <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor13'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmmi-12'>,</span><span id='textcolor14'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span>)<span class='cmsy-10x-x-120'>×</span></td>                                                             <td class='align-label'><a id='x1-14005r27'></a>(27)
                         </td></tr><tr><td class='align-odd'></td>                                             <td class='align-even'><span class='cmmi-12'>f</span>(<span id='textcolor15'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor16'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor17'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>)<span class='cmsy-10x-x-120'>×</span></td>                                                  <td class='align-label'><a id='x1-14006r28'></a>(28)
                         </td></tr><tr><td class='align-odd'></td>                                             <td class='align-even'><span class='cmmi-12'>f</span>(<span id='textcolor18'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span></td>                                                               <td class='align-label'><a id='x1-14007r29'></a>(29)                         </td></tr></table>
<!-- l. 360 --><p class='indent'>   Thus, the expected value of the outcome <span class='cmmi-12'>Y </span>is:
</p><!-- l. 362 --><p class='indent'>
                                                                                                  
                                                                                                  
</p><table class='align'>
                 <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main19x.svg' /></td>                 <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>yf</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y</span>)</td>                                                                    <td class='align-label'><a id='x1-14008r30'></a>(30)
                 </td></tr><tr><td class='align-odd'></td>                       <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>y </span><span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor19'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmmi-12'>,</span><span id='textcolor20'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span>)</td>                                  <td class='align-label'><a id='x1-14009r31'></a>(31)
                 </td></tr><tr><td class='align-odd'></td>                       <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
          <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub>   <span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[Y |L0 = l0,L1 = l1,A0 = a0, A1 = a1]' class='left' src='main20x.svg' /> <span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor21'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor22'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>)<span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor23'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>)<span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor24'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span>                    </td>                                  <td class='align-label'><a id='x1-14010r32'></a>(32)                 </td></tr></table>
<!-- l. 375 --><p class='noindent'><span class='likeparagraphHead' id='algorithms2'><a id='x1-15000'></a>Algorithms</span>
   One estimator of <span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup>[<span class='cmmi-12'>Y </span>] is the <span class='cmbx-12'>parametric g-computation formula</span>. For the case of a deterministic
static intervention with one exposure and two time points, we can rewrite Equation <a href='#x1-14010r32'>32<!-- tex4ht:ref: eq:gform_long_static  --></a> so that it
corresponds to a series of conditional expectations:
</p><!-- l. 378 --><p class='indent'>
</p><table class='align'>
                 <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main21x.svg' /></td>                 <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
          <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub>   <span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[Y |L0 = l0,L1 = l1,A0 = a0, A1 = a1]' class='left' src='main22x.svg' /> <span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor25'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor26'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor27'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>)<span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor28'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>) <span class='cmsy-10x-x-120'>× </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)           </td>                                  <td class='align-label'><a id='x1-15001r33'></a>(33)
                 </td></tr><tr><td class='align-odd'></td>                       <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
          <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub>   <span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[Y |L0 = l0,L1 = l1,A0 = a0, A1 = a1]' class='left' src='main23x.svg' /> <span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor29'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub></span><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor30'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span>)<span class='cmsy-10x-x-120'>×
             </span><span class='cmmi-12'>f</span>(<span id='textcolor31'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub></span><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span>                 </td>                                  <td class='align-label'><a id='x1-15002r34'></a>(34)                 </td></tr></table>
                                                                                                  
                                                                                                  
<!-- l. 394 --><p class='indent'>   Equation <a href='#x1-15002r34'>34<!-- tex4ht:ref: eq:nested_gcom_long_static  --></a> suggests a different form for the parametric g-computation formula, which in the literature
is usually called iterated conditional expectation (ICE) g-computation formula. The pseudo-algorithm then
reads as follows (<span class='cmmi-12'>Ā</span><sub><span class='cmmi-8'>t</span></sub> means the history of <span class='cmmi-12'>A </span>up to time <span class='cmmi-12'>t</span>):
</p><!-- l. 396 --><p class='indent'>
      </p><ol class='enumerate1'>
<li class='enumerate' id='x1-15004x1'>Fit a regression model with dependent variable <span class='cmmi-12'>Y </span>and independent variables <span class='cmmi-12'>Ā</span><sub><span class='cmr-8'>1</span></sub> and <span class='bar-css'><span class='cmmi-12'>L</span></span><sub><span class='cmr-8'>1</span></sub>.
      </li>
<li class='enumerate' id='x1-15006x2'>Estimate the outcome <span class='cmmi-12'>Y</span> <sup><span class='cmmi-8'>ā</span><sub><span class='cmr-6'>1</span></sub></sup> using the model fit in the previous point but changing the exposure
      <span class='cmmi-12'>A</span><sub><span class='cmr-8'>1</span></sub> according to the intervention rule <span class='cmmi-12'>G</span>.
      </li>
<li class='enumerate' id='x1-15008x3'>Fit a regression model with dependent variable <span class='cmmi-12'>Ŷ</span><sup><span class='cmmi-8'>ā</span><sub><span class='cmr-6'>1</span></sub></sup>  and independent variables <span class='cmmi-12'>A</span><sub>
<span class='cmr-8'>0</span></sub> and <span class='cmmi-12'>L</span><sub><span class='cmr-8'>0</span></sub>.
      </li>
<li class='enumerate' id='x1-15010x4'>Estimate the outcome <span class='cmmi-12'>Y</span> <sup><span class='cmmi-8'>ā</span><sub><span class='cmr-6'>0</span></sub></sup> using the model fit in the previous point but changing the exposure
      <span class='cmmi-12'>A</span><sub><span class='cmr-8'>0</span></sub> according to the intervention rule <span class='cmmi-12'>G</span>.
      </li>
<li class='enumerate' id='x1-15012x5'>Take the average of <span class='cmmi-12'>Ŷ</span><sup><span class='cmmi-8'>ā</span><sub><span class='cmr-6'>0</span></sub></sup>  over the confounders <span class='cmmi-12'>L</span><sub>
<span class='cmr-8'>0</span></sub>.</li></ol>
<!-- l. 404 --><p class='indent'>   In the case of more than two time points, simply repeat the steps above until reaching <span class='cmmi-12'>t </span>= 0. The ICE
g-computation formula is appealing because it does not require the specification of models for the
confounders at each time point.
</p><!-- l. 406 --><p class='indent'>   In the case of multiple exposures (e.g., if <span class='cmmi-12'>A</span><sub><span class='cmmi-8'>t</span></sub> is actually a vector of variables), the g-formula would remain the
same <span class='footnote-mark'><a href='main4.html#fn3x0'><sup class='textsuperscript'>3</sup></a></span><a id='x1-15013f3'></a> ,
but the pseudo-algorithm should be modified to take into account that the intervention rule now applies to
all exposures <span class='cmmi-12'>a</span><sub><span class='cmmi-8'>t</span></sub> <span class='cmsy-10x-x-120'>∈ </span><span class='cmbx-12'>A</span><sub><span class='cmbx-8'>t</span></sub>.
</p>
   <h5 class='subsubsectionHead' id='deterministic-dynamic-treatment-regimes1'><span class='titlemark'>3.1.2   </span> <a id='x1-160003.1.2'></a>Deterministic Dynamic Treatment Regimes</h5>
<!-- l. 409 --><p class='noindent'>The rule for assigning treatment depends on past treatment or covariates.
                                                                                                  
                                                                                                  
</p><!-- l. 411 --><p class='indent'>   If <span class='cmmi-12'>f</span><sup>int</sup>(<span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><span class='cmsy-10x-x-120'>|</span><span class='bar-css'><span class='cmmi-12'>l</span></span><sub><span class='cmmi-8'>k</span></sub><span class='cmmi-12'>,ā</span><sub><span class='cmmi-8'>k</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span class='bar-css'><span class='cmmi-12'>D</span></span><sub><span class='cmmi-8'>k</span></sub> = 0) is either 0 or 1 for each (<span class='cmmi-12'>ā</span><sub><span class='cmmi-8'>k</span></sub><span class='cmmi-12'>,</span><span class='bar-css'><span class='cmmi-12'>l</span></span><sub><span class='cmmi-8'>k</span></sub>) and for <span class='cmmi-12'>k </span>= 0<span class='cmmi-12'>,…,K</span>. In particular, given
the regime <span class='cmmi-12'>g </span>= (<span class='cmmi-12'>g</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,…,g</span><sub><span class='cmmi-8'>K</span></sub>), <span class='cmmi-12'>f</span><sup>int</sup>(<span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><span class='cmsy-10x-x-120'>|</span><span class='bar-css'><span class='cmmi-12'>l</span></span><sub><span class='cmmi-8'>k</span></sub><span class='cmmi-12'>,ā</span><sub><span class='cmmi-8'>k</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,</span><span class='bar-css'><span class='cmmi-12'>D</span></span><sub>
<span class='cmmi-8'>k</span></sub> = 0) = 1 if <span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub> = <span class='cmmi-12'>a</span><sub><span class='cmmi-8'>k</span></sub><sup><span class='cmmi-8'>g</span></sup>, and 0 otherwise, with
<span class='cmmi-12'>a</span><sub><span class='cmmi-8'>s</span></sub><sup><span class='cmmi-8'>g</span></sup> = <span class='cmmi-12'>g</span><sub>
<span class='cmmi-8'>s</span></sub>(<span class='bar-css'><span class='cmmi-12'>l</span></span><sub><span class='cmmi-8'>s</span></sub><span class='cmmi-12'>,ā</span><sub><span class='cmmi-8'>s</span><span class='cmsy-8'>−</span><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>).
</p><!-- l. 413 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='deterministic-natural-treatment-regimes1'><span class='titlemark'>3.1.3   </span> <a id='x1-170003.1.3'></a>Deterministic Natural Treatment Regimes</h5>
<!-- l. 414 --><p class='noindent'>The rule for assigning treatment depends on its natural value.
</p>
   <figure class='figure' id='-a-swig-representing-a-natural-treatment-regime1'> 

                                                                                                  
                                                                                                  
<a id='x1-170015'></a>
                                                                                                  
                                                                                                  
<!-- l. 459 --><p class='noindent'>        L<sub><span class='cmr-8'>0</span></sub>A<sub><span class='cmr-8'>0</span></sub><span class='msam-10x-x-120'>−−→</span>A<sub><span class='cmr-8'>0</span> </sub><sup><span class='cmr-8'>+</span><span class='cmmi-8'>g</span></sup>L<sub>
<span class='cmr-8'>1</span></sub>A<sub><span class='cmr-8'>1</span></sub><span class='msam-10x-x-120'>−−→</span>A<sub><span class='cmr-8'>1</span> </sub><sup><span class='cmr-8'>+</span><span class='cmmi-8'>g</span></sup>Y
</p>
<figcaption class='caption'><span class='id'>Figure 5: </span><span class='content'>A SWIG representing a natural treatment regime.</span></figcaption><!-- tex4ht:label?: x1-170015  -->
                                                                                                  
                                                                                                  
   </figure>
<!-- l. 464 --><p class='indent'>   The joint density is:
</p><!-- l. 466 --><p class='indent'>
</p><table class='align'>
                            <tr><td class='align-odd'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y,l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>) =</td>                            <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>)<span class='cmsy-10x-x-120'>×</span></td>                                                         <td class='align-label'><a id='x1-17002r35'></a>(35)
                            </td></tr><tr><td class='align-odd'></td>                                                      <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                        <td class='align-label'><a id='x1-17003r36'></a>(36)
                            </td></tr><tr><td class='align-odd'></td>                                                      <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup>)<span class='cmsy-10x-x-120'>×</span></td>                                                            <td class='align-label'><a id='x1-17004r37'></a>(37)
                            </td></tr><tr><td class='align-odd'></td>                                                      <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup>)<span class='cmsy-10x-x-120'>×</span></td>                                                               <td class='align-label'><a id='x1-17005r38'></a>(38)
                            </td></tr><tr><td class='align-odd'></td>                                                      <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                              <td class='align-label'><a id='x1-17006r39'></a>(39)
                            </td></tr><tr><td class='align-odd'></td>                                                      <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span></td>                                                               <td class='align-label'><a id='x1-17007r40'></a>(40)                            </td></tr></table>
<!-- l. 475 --><p class='indent'>   After intervening on the exposure <span class='cmmi-12'>A</span>, we have:
</p><!-- l. 477 --><p class='indent'>
</p><table class='align'>
                           <tr><td class='align-odd'><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>) =</td>                           <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>y</span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor32'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmmi-12'>,</span><span id='textcolor33'><span class='cmmi-12'>a</span><sub>
<span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup>)</span><span class='cmsy-10x-x-120'>×</span></td>                                                       <td class='align-label'><a id='x1-17008r41'></a>(41)
                           </td></tr><tr><td class='align-odd'></td>                                                       <td class='align-even'><span class='cmmi-12'>f</span>(<span id='textcolor34'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor35'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                      <td class='align-label'><a id='x1-17009r42'></a>(42)
                           </td></tr><tr><td class='align-odd'></td>                                                       <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor36'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmsy-10x-x-120'>×</span></td>                                                          <td class='align-label'><a id='x1-17010r43'></a>(43)
                           </td></tr><tr><td class='align-odd'></td>                                                       <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor37'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmsy-10x-x-120'>×</span></td>                                                             <td class='align-label'><a id='x1-17011r44'></a>(44)
                           </td></tr><tr><td class='align-odd'></td>                                                       <td class='align-even'><span class='cmmi-12'>f</span>(<span id='textcolor38'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmsy-10x-x-120'>×</span></td>                                                             <td class='align-label'><a id='x1-17012r45'></a>(45)
                           </td></tr><tr><td class='align-odd'></td>                                                       <td class='align-even'><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span></td>                                                             <td class='align-label'><a id='x1-17013r46'></a>(46)                           </td></tr></table>
                                                                                                  
                                                                                                  
<!-- l. 486 --><p class='indent'>   Thus, the expected value of the outcome <span class='cmmi-12'>Y </span>is:
</p><!-- l. 488 --><p class='indent'>
</p><table class='align'>
             <tr><td class='align-odd'><span class='msbm-10x-x-120'>𝔼</span><sup><span class='cmmi-8'>G</span></sup><img align='middle' alt='[Y ]' class='left' src='main24x.svg' /></td>             <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>yf</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y</span>)</td>                                                                                 <td class='align-label'><a id='x1-17014r47'></a>(47)
             </td></tr><tr><td class='align-odd'></td>                   <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>y</span></sub><span class='cmmi-12'>y </span><span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
         <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub><sup><span class='cmmi-6'>g</span></sup></sub> <span class='cmex-10x-x-120'>∑</span>
                 <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
                     <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub><sup><span class='cmmi-6'>g</span></sup></sub><span class='cmmi-12'>f</span><sup><span class='cmmi-8'>G</span></sup>(<span class='cmmi-12'>y,l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor39'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor40'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup></span>)</td>                          <td class='align-label'><a id='x1-17015r48'></a>(48)
             </td></tr><tr><td class='align-odd'></td>                   <td class='align-even'> = <span class='cmex-10x-x-120'>∑</span>
   <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
      <sub><span class='cmmi-8'>l</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
          <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
             <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>0</span></sub><sup><span class='cmmi-6'>g</span></sup></sub> <span class='cmex-10x-x-120'>∑</span>
                 <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub></sub> <span class='cmex-10x-x-120'>∑</span>
                     <sub><span class='cmmi-8'>a</span><sub><span class='cmr-6'>1</span></sub><sup><span class='cmmi-6'>g</span></sup></sub>   <span class='msbm-10x-x-120'>𝔼</span><img align='middle' alt='[Y |L0 = l0,L1 = l1,A0 = ag0,A1  = ag1]' class='left' src='main25x.svg' /> <span class='cmsy-10x-x-120'>×
                    </span><span class='cmmi-12'>f</span>(<span id='textcolor41'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor42'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmmi-12'>,a</span><sub>
<span class='cmr-8'>1</span></sub>)<span class='cmsy-10x-x-120'>×
                    </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,l</span><sub><span class='cmr-8'>1</span></sub><span class='cmmi-12'>,</span><span id='textcolor43'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmsy-10x-x-120'>×
                    </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>1</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub><span class='cmmi-12'>,</span><span id='textcolor44'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span>)<span class='cmsy-10x-x-120'>×
                    </span><span class='cmmi-12'>f</span>(<span id='textcolor45'><span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><sup><span class='cmmi-8'>g</span></sup></span><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub>
<span class='cmr-8'>0</span></sub><span class='cmmi-12'>,a</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmsy-10x-x-120'>×
                    </span><span class='cmmi-12'>f</span>(<span class='cmmi-12'>a</span><sub><span class='cmr-8'>0</span></sub><span class='cmsy-10x-x-120'>|</span><span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>f</span>(<span class='cmmi-12'>l</span><sub><span class='cmr-8'>0</span></sub>)<span class='cmmi-12'>.</span>                </td>                               <td class='align-label'><a id='x1-17016r49'></a>(49)             </td></tr></table>
   <h5 class='subsubsectionHead' id='modified-treatment-policies1'><span class='titlemark'>3.1.4   </span> <a id='x1-180003.1.4'></a>Modified Treatment Policies</h5>
<!-- l. 504 --><p class='noindent'>
</p>
   <h4 class='subsectionHead' id='random-treatment-regimes1'><span class='titlemark'>3.2   </span> <a id='x1-190003.2'></a>Random Treatment Regimes</h4>
<!-- l. 505 --><p class='noindent'>The rule for assigning treatment does so with probability between 0 and 1.
</p><!-- l. 507 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='random-static-treatment-regimes'><span class='titlemark'>3.2.1   </span> <a id='x1-200003.2.1'></a>Random Static Treatment Regimes</h5>
<!-- l. 508 --><p class='noindent'>The rule for assigning treatment does not depend on past covariates.
</p><!-- l. 510 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='random-dynamic-treatment-regimes'><span class='titlemark'>3.2.2   </span> <a id='x1-210003.2.2'></a>Random Dynamic Treatment Regimes</h5>
<!-- l. 511 --><p class='noindent'>The rule for assigning treatment depends on past covariates.
                                                                                                  
                                                                                                  
</p><!-- l. 513 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='random-natural-treatment-regimes'><span class='titlemark'>3.2.3   </span> <a id='x1-220003.2.3'></a>Random Natural Treatment Regimes</h5>
<!-- l. 514 --><p class='noindent'>The rule for assigning treatment depends on its natural value.
</p><!-- l. 516 --><p class='noindent'>
</p>
   <h5 class='subsubsectionHead' id='modified-treatment-policies2'><span class='titlemark'>3.2.4   </span> <a id='x1-230003.2.4'></a>Modified Treatment Policies</h5>
    
</body> 
</html>